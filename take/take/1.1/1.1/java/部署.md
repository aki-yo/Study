## 繁

### **使用 `cd ../目录名` 跳转到同级目录**

bash

cd ../another_dir

- `../` 表示上级目录，后面接目标目录名可以跳转到**兄弟目录**（同级目录）。

## 后端

sbvue 大事件 
账号密码：wangba 123456

打包的时候要用这个使之跳过测试

![[Pasted image 20250625171837.png]]

然后需要Jdk.bin.tar.gz  dockerfile  xxx.jar


创建文件夹
上传文件
执行命令


```powershell
#传入文件夹了进入这个文件夹
cd /root/bigevent

#上传资料

#根据dockerfile构建镜像
docker build -t bigevent:1.0 .


#查看这个jdk解压后的文件夹名字是什么
# 查看压缩包内的顶层目录名发现是jdk-17.0.15,根据这个改dockerfile
tar -tf jdk17.tar.gz | head -n 1  

#根据镜像创建容器
docker run -d --name bigevent-server --network ohh -p 8080:8080  bigevent:1.0
```


## 前端

需要vue打包

```
npm install
npm run build
```


```
mkdir /usr/local/app/bigevent/bigevent-nginx-vue/html
```


上传文件记得

命令直接创建
```PowerShell
docker run -d \
--name bigevent-nginx-vue \
-v /usr/local/app/bigevent/bigevent-nginx-vue/html:/usr/share/nginx/html \
-v /usr/local/app/bigevent/bigevent-nginx-vue/conf/nginx.conf:/etc/nginx/nginx.conf \
--network ohh \
-p 80:80 \
nginx:1.20.2
```



### 测试
```
# 进入前端容器
docker exec -it bigevent-nginx-vue sh

# 测试是否能访问后端
curl http://bigevent-server:8080/login
```

## mysql 

```PowerShell
docker run -d \
  --name mysql \
  -v /usr/local/app/bigevent/mysql/init.sql:/docker-entrypoint-initdb.d/init.sql \
  --network ohh \
  -p 3307:3306 \
  -e TZ=Asia/Shanghai \
  -e MYSQL_ROOT_PASSWORD=123456 \
  mysql:8
```


### 测试
```
docker exec -it mysql mysql -uroot -p #第一个mysql是容器名字
USE big_event;
SHOW TABLES;
```



## redis
```
docker run -d \
  --name redis \
  --network ohh \
  -p 6379:6379 \
  redis:latest  
```






## 过程


如果服务异常，记得检查
检查我以为是打包的问题，以为没有js的问题

但是突然发现有js

然后经过查资料好像打包过程有问题
查询发现要改vue.config.js
但是我又发现我是vite.config.js
然后我就问npm vite vue
是什么关系
然后知道了
然后我知道了npm run build 实际上会运行vite build
正好符合官网操作的vite build
那这不是对吗
然后我就想看这个npm run preview看看什么个情况
然后通过cmd可以绕过

![[Pasted image 20250626224622.png]]
这个错误（本来那个管理员运行看着挺吓人的还是算了
![[Pasted image 20250626224828.png]]




然后我就开始
![[Pasted image 20250626224652.png]]
然后就发现了正确的进入目录的方法


然后发现preview也是服务异常

然后跳转登录

然后我试着运行java后台
发现可以了

记得wangba  123456

现在应该知道是后端没连上的问题了

切换test配置文件进行配置
```
npm run build -- --mode test
```

发现还是服务异常
然后想着直接替换原路径算了，不用引入外部文件了
然后就发现这个玩意外面有引号

![[Pasted image 20250627123414.png]]

然后对比ds发现他没有引号
合着一开始根本就没切换这个url


修改之后就。。。

![[Pasted image 20250627124055.png]]

又是几次错误。。。
```

error during build:
ReferenceError: env is not defined

error during build:
ReferenceError: loadEnv is not defined

#没有引入mode
error during build:
ReferenceError: mode is not defined

#重复引用
error during build:
Error: Build failed with 2 errors:
vite.config.js:8:9: ERROR: The symbol "defineConfig" has already been declared
vite.config.js:8:23: ERROR: The symbol "loadEnv" has already been declared


```


所以配置代码从这个
```

import { fileURLToPath, URL } from 'node:url'


import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import vueDevTools from 'vite-plugin-vue-devtools'
// https://vite.dev/config/
// export default defineConfig({
//   plugins: [
//     vue(),
//     vueDevTools(),
//   ],
//   resolve: {
//     alias: {
//       '@': fileURLToPath(new URL('./src', import.meta.url))
//     },
//   },
//   server:{
//     proxy:{
//       '/api':{//获取路径中包含了/api的请求
//           target:'http://localhost:8080',//后台服务所在的源
//           changeOrigin:true,//修改源
//           rewrite:(path)=>path.replace(/^\/api/,'')///api替换为''
//       }
//     }
//   },
// })
```

变成了这个

```
import { fileURLToPath, URL } from 'node:url'
import { defineConfig ,loadEnv} from 'vite'
import vue from '@vitejs/plugin-vue'
import vueDevTools from 'vite-plugin-vue-devtools'

export default defineConfig(({ mode }) => {
  // 1. 加载环境变量（根据 --mode 参数读取对应的 .env 文件）
  const env = loadEnv(mode, process.cwd())
  // 2. 返回配置
  return {
    plugins: [
      vue(),
      vueDevTools(),
    ],
    resolve: {
      alias: {
        '@': fileURLToPath(new URL('./src', import.meta.url))
      },
    },
    server:{
      proxy:{
        '/api':{//获取路径中包含了/api的请求
            target:env.VITE_API_BASE_URL,//后台服务所在的源
            changeOrigin:true,//修改源
            rewrite:(path)=>path.replace(/^\/api/,'')///api替换为''
        }
      }
    },
  }
})
```


疯了还是不对

```
# 进入前端容器
docker exec -it bigevent-nginx-vue sh

# 测试是否能访问后端
curl http://bigevent-server:8080/article/category
```

然后我测试了用本地的vue访问linux内的server
就是
```
          target:'http://192.168.221.135:8080',//后台服务所在的源
```
改成这样

发现是操作失败

然后去idea中找到了这个文本

然后又去vscode中找意外发现了 服务异常 文本
！！！
原来如果没有连接到后端就是服务异常
但是操作异常是怎么回事
emmm好像mysql没有数据吧。。。。。。。
！
但是就算解决了数据问题，一开始的服务异常怎么办

草
注册也操作失败

如果能看到异常就好了

哦哦，看日志去

![[Pasted image 20250627144651.png]]
就这个爽



![[Pasted image 20250627152938.png]]

这个玩意是因为
```
state       varchar(10) default '草稿' null comment '文章状态: 只能是[已发布] 或者 [草稿]',

```
这个字段那个10一开始是3，太小了
导致这个数据表没有创建成功
所以table 'big_event.article'是正确


现在好了
现在是本地前端访问linux后端，没问题


尼玛

从别的b站的地方看到要配置nginx.conf
结果去黑马那个地方一看他妈的它的就是vue项目本来
他就是vue经过nginx配置
我草了
直接看黑马不就好了
而且一看
发现我之前就看过
我忘记了
尼玛
我服了

可是
我弄了之后
![[Pasted image 20250627170155.png]]
还是错！！！！！！！！！！


![[Pasted image 20250627171757.png]]



草
终于成功了

草！！！！！！！！！！！！
那个root 后面的还是要改，因为那个下载的Nginx就是单目录，可以直接识别到html
但是容器里面不是
b站教程也改了
终于成了
超了

哎
还要体检

才弄了个这个玩意

服了




## dockercompose

```YAML
services:  
  mysql:  
    image: mysql:8  
    container_name: mysql  
    ports:  
      - "3307:3306"  
    environment:  
      TZ: Asia/Shanghai  
      MYSQL_ROOT_PASSWORD: 123456  
    volumes:  
      - "/usr/local/app/bigevent_1.1/mysql/:/docker-entrypoint-initdb.d"  
    networks:  
      - be-ohh  
  redis:  
    image: redis:latest  
    container_name: redis  
    ports:  
      - "6379:6379"  
    networks:  
      - be-ohh  
  bigevent-server:  
    build:  
      context: .  
      dockerfile: bigevent-server/Dockerfile  
    image: bigevent:1.1  # 自定义镜像名称和标签  
    container_name: bigevent-server  
    ports:  
      - "8080:8080"  
    networks:  
      - be-ohh  
    depends_on:  
      - mysql  
  nginx-vue:  
    image: nginx:1.20.2  
    container_name: nginx-vue  
    ports:  
      - "80:80"  
    volumes:  
      - "/usr/local/app/bigevent_1.1/bigevent-nginx-vue/conf/nginx.conf:/etc/nginx/nginx.conf"  
      - "/usr/local/app/bigevent_1.1/bigevent-nginx-vue/html:/usr/share/nginx/html"  
    depends_on:  
      - bigevent-server  
    networks:  
      - be-ohh  
networks:  
  be-ohh:  
    name: ohh
    external: true
```
services中的键是这个文件内部互相引用的时候用到的，



```powershell
docker compose up -d
```





# end